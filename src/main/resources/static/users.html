<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户 - Microsoft 365 管理系统</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/materialdesignicons.min.css" rel="stylesheet">
    <link href="css/style.min.css" rel="stylesheet">
    <!--对话框-->
    <link href="js/jconfirm/jquery-confirm.min.css" rel="stylesheet">
    <link href="css/style.min.css" rel="stylesheet">
    <link href="css/gm.css" rel="stylesheet">
    <link href="css/gm-diy.css" rel="stylesheet">

</head>
<body>
<div class="lyear-layout-web">
    <div class="lyear-layout-container">
        <!--左侧导航-->
        <aside class="lyear-layout-sidebar">

            <!-- logo -->
            <div id="logo" class="sidebar-header">
                <a href="index.html"><img src="images/logo-sidebar.png" title="LightYear"
                                          alt="LightYear"/></a>
            </div>
            <div class="lyear-layout-sidebar-scroll">
                <nav class="sidebar-main">
                    <ul class="nav nav-drawer">
                        <li class="nav-item nav-item-has-subnav">
                            <a href="index.html"><i class="mdi mdi-home"></i> 后台首页</a>
                        </li>
                        <li class="nav-item nav-item-has-subnav ">
                            <a href="licenses.html"><i class="mdi mdi-shape-rectangle-plus"></i>订阅管理</a>
                        </li>
                        <li class="nav-item nav-item-has-subnav active">
                            <a href="users.html"><i class="mdi mdi-account-multiple"></i>用户管理</a>
                        </li>
                        <li class="nav-item nav-item-has-subnav">
                            <a href="code.html"><i class="mdi mdi-account-star"></i>邀请管理</a>
                        </li>
                        <li class="nav-item nav-item-has-subnav">
                            <a href="about.html"><i class="mdi mdi-information-variant"></i>关于平台</a>
                        </li>
                    </ul>
                </nav>
            </div>

        </aside>
        <!--End 左侧导航-->

        <!--头部信息-->
        <!--        <div class="headerPage"></div>-->
        <header class="lyear-layout-header">

            <nav class="navbar navbar-default">
                <div class="topbar">

                    <div class="topbar-left">
                        <div class="lyear-aside-toggler">
                            <span class="lyear-toggler-bar"></span>
                            <span class="lyear-toggler-bar"></span>
                            <span class="lyear-toggler-bar"></span>
                        </div>
                        <span class="navbar-page-title" id="titleName"> 后台首页 </span>
                    </div>

                    <ul class="topbar-right">
                        <!--切换主题配色-->
                        <li class="dropdown dropdown-skin">
                            <span data-toggle="dropdown" class="icon-palette"><i class="mdi mdi-palette"></i></span>
                            <ul class="dropdown-menu dropdown-menu-right" data-stopPropagation="true">
                                <li class="drop-title"><p>主题</p></li>
                                <li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="site_theme" value="default" id="site_theme_1" checked>
                    <label for="site_theme_1"></label>
                  </span>
                                    <span>
                    <input type="radio" name="site_theme" value="dark" id="site_theme_2">
                    <label for="site_theme_2"></label>
                  </span>
                                    <span>
                    <input type="radio" name="site_theme" value="translucent" id="site_theme_3">
                    <label for="site_theme_3"></label>
                  </span>
                                </li>
                                <li class="drop-title"><p>LOGO</p></li>
                                <li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="logo_bg" value="default" id="logo_bg_1" checked>
                    <label for="logo_bg_1"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_2" id="logo_bg_2">
                    <label for="logo_bg_2"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_3" id="logo_bg_3">
                    <label for="logo_bg_3"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_4" id="logo_bg_4">
                    <label for="logo_bg_4"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_5" id="logo_bg_5">
                    <label for="logo_bg_5"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_6" id="logo_bg_6">
                    <label for="logo_bg_6"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_7" id="logo_bg_7">
                    <label for="logo_bg_7"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_8" id="logo_bg_8">
                    <label for="logo_bg_8"></label>
                  </span>
                                </li>
                                <li class="drop-title"><p>头部</p></li>
                                <li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="header_bg" value="default" id="header_bg_1" checked>
                    <label for="header_bg_1"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_2" id="header_bg_2">
                    <label for="header_bg_2"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_3" id="header_bg_3">
                    <label for="header_bg_3"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_4" id="header_bg_4">
                    <label for="header_bg_4"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_5" id="header_bg_5">
                    <label for="header_bg_5"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_6" id="header_bg_6">
                    <label for="header_bg_6"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_7" id="header_bg_7">
                    <label for="header_bg_7"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_8" id="header_bg_8">
                    <label for="header_bg_8"></label>
                  </span>
                                </li>
                                <li class="drop-title"><p>侧边栏</p></li>
                                <li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="sidebar_bg" value="default" id="sidebar_bg_1" checked>
                    <label for="sidebar_bg_1"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_2" id="sidebar_bg_2">
                    <label for="sidebar_bg_2"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_3" id="sidebar_bg_3">
                    <label for="sidebar_bg_3"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_4" id="sidebar_bg_4">
                    <label for="sidebar_bg_4"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_5" id="sidebar_bg_5">
                    <label for="sidebar_bg_5"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_6" id="sidebar_bg_6">
                    <label for="sidebar_bg_6"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_7" id="sidebar_bg_7">
                    <label for="sidebar_bg_7"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_8" id="sidebar_bg_8">
                    <label for="sidebar_bg_8"></label>
                  </span>
                                </li>
                            </ul>
                        </li>
                        <!--切换主题配色-->

                        <!-- 切换组织类型-->
                        <div class="form-group">
                            <div class="col-xs-12">
                                <label for="appNameSelect"></label>
                                <select id="appNameSelect" class="form-control" name="app-select" size=""
                                        onchange="reloadPage()">
                                </select>
                            </div>
                        </div>
                        <div class="col-xs-5">
                            <button class="btn btn-label" id="clearCache" onclick="refreshCache(listUsers)"><label><i
                                    class="mdi mdi-cached"></i></label>刷新缓存
                            </button>
                        </div>
                    </ul>

                </div>
            </nav>

        </header>
        <!--End 头部信息-->

        <!--页面主要内容-->
        <main class="lyear-layout-content">
            <div class="container-fluid">
                <!-- 用户-->
                <div class="row">
                    <div class="col-sm-6 col-lg-3">
                        <div class="card ">
                            <div class="card-body clearfix">
                                <div class="pull-right">
                                    <p class="h6 m-t-0">总用户数</p>
                                    <p class="h3 m-b-0" id="users">0</p>
                                </div>
                                <div class="pull-left"><span class="img-avatar img-avatar-48 bg-translucent"><i
                                        class="mdi mdi-account fa-1-5x"></i></span></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-lg-3">
                        <div class="card ">
                            <div class="card-body clearfix">
                                <div class="pull-right">
                                    <p class="h6  m-t-0">允许登陆</p>
                                    <p class="h3  m-b-0" id="allowedUsers">0</p>
                                </div>
                                <div class="pull-left"><span class="img-avatar img-avatar-48 bg-translucent"><i
                                        class="mdi mdi-account-check fa-1-5x"></i></span></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-lg-3">
                        <div class="card ">
                            <div class="card-body clearfix">
                                <div class="pull-right">
                                    <p class="h6 m-t-0">禁止登陆</p>
                                    <p class="h3 m-b-0" id="biddenUsers">0</p>
                                </div>
                                <div class="pull-left"><span class="img-avatar img-avatar-48 bg-translucent"><i
                                        class="mdi mdi-account-off fa-1-5x"></i></span></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-lg-3">
                        <div class="card">
                            <div class="card-body clearfix">
                                <div class="pull-right">
                                    <p class="h6 m-t-0">未授权</p>
                                    <p class="h3 m-b-0" id="unauthorizedUsers">0</p>
                                </div>
                                <div class="pull-left"><span class="img-avatar img-avatar-48 bg-translucent"><i
                                        class="mdi mdi-account-alert fa-1-5x"></i></span></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 搜索框-->
                <div class="row">

                    <div class="col-xs-2">
                        <label for="license"></label>
                        <select class="form-control" id="license" name="license-select" size="1">
                            <option value="" disabled selected hidden>请选择许可证</option>
                            <option value="">不限制</option>
                        </select>
                    </div>
                    <div class="col-xs-2">
                        <label for="accountEnabled"></label>
                        <select class="form-control" id="accountEnabled" name="login-select" size="1">
                            <option value="" disabled selected hidden>是否允许登录</option>
                            <option value="">不限制</option>
                            <option value="1">允许</option>
                            <option value="0">禁止</option>
                        </select>
                    </div>
                    <div class="col-xs-2">
                        <label for="assignLicense"></label>
                        <select class="form-control" id="assignLicense" name="auth-select" size="1">
                            <option value="" disabled selected hidden>是否授权</option>
                            <option value="">不限制</option>
                            <option value="1">已授权</option>
                            <option value="0">未授权</option>
                        </select>
                    </div>

                    <div class="col-xs-2">
                        <label for="userPrincipalName"></label>
                        <input class="form-control" type="text" id="userPrincipalName"
                               name="account-text-input"
                               style="height: 33px"
                               placeholder="请输入账号">
                    </div>
                    <div class="col-xs-2">
                        <label for="displayName"></label>
                        <input class="form-control" type="text" id="displayName"
                               name="display-name-text-input"
                               style="height: 33px"
                               placeholder="请输入姓名">
                    </div>
                    <div class="col-xs-2">
                        <button class="btn btn-info"
                                style="margin:21px auto auto auto; height: 33px"
                                type="submit" onclick="searchUsers()">搜索
                        </button>
                    </div>

                </div>
                <br>
                <!-- 表单-->
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-toolbar clearfix">
                                <!-- 操作按钮-->
                                <div class="row">
                                    <div class="col-xs-12">
                                        <div class="toolbar-btn-action" style=" height: 33px">
                                            <a class="btn m-r-10" data-toggle="modal"
                                               data-target=".bs-add-modal-lg">
                                                <i class="mdi mdi-plus" id="add"></i> 新增
                                            </a>
                                            <a class="btn m-r-10 enable-account-p disabled" id="enableAccount"
                                               href="#!"><i
                                                    class="mdi mdi-check"></i> 启用</a>
                                            <a class="btn m-r-10 disable-account-p disabled" id="disableAccount"
                                               href="#!"><i
                                                    class="mdi mdi-block-helper"></i> 禁用</a>
                                            <a class="btn m-r-10 deleted-account-p disabled" id="deletedAccount"
                                               href="#!"><i
                                                    class="mdi mdi-window-close"></i> 删除</a>
                                            <a class="btn m-r-10 add-license-account-p disabled" id="addLicenseAccount"
                                               data-toggle="modal"
                                               data-target=".bs-auth-modal-lg">
                                                <i class="mdi mdi-office"></i> 授权
                                            </a>
                                            <a class="btn m-r-10 disabled"
                                               id="addDirectoryRoleMember"
                                               data-toggle="modal"
                                               data-target=".bs-add-directory-role-member-lg">
                                                <i class="mdi mdi-office"></i> 提权
                                            </a>
                                            <a class="btn m-r-10 dis-license-account-p disabled" id="disLicenseAccount"
                                               data-toggle="modal"
                                               data-target=".bs-dis-auth-modal-lg">
                                                <i class="mdi mdi-office"></i> 取消
                                            </a>
                                            <a class="btn m-r-10 deleted-account-p-batch pull-right"
                                               id="deletedAccountBatch" href="#!"><i class="mdi mdi-delete"></i>
                                                全部删除</a>
                                            <a class="btn m-r-10  bs-user-batch-modal-lg pull-right"
                                               id="addUserBatchLabel"
                                               data-toggle="modal"
                                               data-target=".bs-user-batch-modal-lg">
                                                <i class="mdi mdi-playlist-plus"></i> 批量创建
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <!--模糊框-->
                                <div class="modal fade bs-add-modal-lg" tabindex="-1" role="dialog"
                                     aria-labelledby="addLabel">
                                    <div class="modal-dialog modal-lg" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close"><span
                                                        aria-hidden="true">×</span></button>
                                                <h4 class="modal-title" id="addLabel">新增账户</h4>
                                            </div>
                                            <div class="modal-body col-xs-12">
                                                <div class="col-xs-6">
                                                    <div class="input-group m-b-10">
                                                            <span class="input-group-addon" id="add-display-name">
                                                                <label for="addDisplayName">显示姓名</label>
                                                            </span>
                                                        <input type="text" class="form-control" placeholder=""
                                                               id="addDisplayName"
                                                               aria-describedby="add-display-name-input">
                                                    </div>
                                                </div>
                                                <div class="col-xs-6">
                                                    <div class="input-group m-b-10">
                                                        <span class="input-group-addon">
                                                            <label for="addLicenseSelect">
                                                                许可证
                                                            </label>
                                                        </span>
                                                        <select class="form-control" id="addLicenseSelect"
                                                                style="height: 38px"
                                                                name="license-select" size="1">
                                                            <option value="" disabled selected hidden>请选择许可证</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-xs-6">
                                                    <div class="input-group m-b-10">
                                                        <span class="input-group-addon">
                                                        <label for="addMailNickname">
                                                            邮箱前缀
                                                        </label>
                                                        </span>
                                                        <input type="text" class="form-control" placeholder=""
                                                               id="addMailNickname"
                                                               aria-describedby="addMailNickname">
                                                    </div>
                                                </div>
                                                <div class="col-xs-6">
                                                    <div class="input-group m-b-10">
                                                        <span class="input-group-addon">
                                                            <label for="addDomainSelect">域名</label>
                                                        </span>
                                                        <select class="form-control" id="addDomainSelect"
                                                                style="height: 38px"
                                                                name="license-select" size="1">
                                                            <option value="" disabled selected hidden>请选择域名后缀</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-xs-6">
                                                    <div class="input-group m-b-10">
                                                            <span class="input-group-addon" id="add-password">
                                                                <label for="addPassword">密&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;码</label>
                                                            </span>
                                                        <input type="text" class="form-control" placeholder=""
                                                               id="addPassword"
                                                               aria-describedby="add-password-input">
                                                    </div>
                                                </div>
                                                <div class="col-xs-6 m-b-10">
                                                    <div class="input-group m-b-10">
                                                        <span class="input-group-addon">
                                                            <label for="addUsageLocation">地区</label>
                                                        </span>
                                                        <select class="form-control" id="addUsageLocation"
                                                                style="height: 38px"
                                                                name="usage-location-select" size="1">
                                                            <!--                                                            <option value="" disabled selected hidden>请选择地区</option>-->
                                                        </select>
                                                    </div>
                                                </div>
                                                <hr>

                                                <div class="col-xs-12">
                                                    <div class="input-group m-b-10">
                                                            <span class="input-group-addon" id="add-mail">
                                                                <label for="addMail">邮件地址</label>
                                                            </span>

                                                        <input type="text" class="form-control"
                                                               placeholder="填写该字段将发送账号密码到该邮箱！"
                                                               id="addMail"
                                                               aria-describedby="add-password-mail">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                                                </button>
                                                <button type="button" class="btn btn-primary" id="addUserClick"
                                                        data-dismiss="modal"
                                                        onclick="addUserClick()">保存
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal fade bs-auth-modal-lg" tabindex="-1" role="dialog"
                                     id="addLicenseModal"
                                     aria-labelledby="authLabel">
                                    <div class="modal-dialog modal-lg" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close"><span
                                                        aria-hidden="true">×</span></button>
                                                <h4 class="modal-title" id="authLabel">分配许可证</h4>
                                            </div>
                                            <div class="modal-body col-xs-12">
                                                <div class="alert alert-success" role="alert" id="addLicenseUser">
                                                </div>
                                                <label for="licenseSelectModal"></label>
                                                <select class="form-control" id="licenseSelectModal"
                                                        style="height: 38px"
                                                        name="license-select" size="1">
                                                    <option value="" disabled selected hidden>请选择许可证</option>
                                                </select>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                                                </button>
                                                <button type="button" class="btn btn-primary" data-dismiss="modal"
                                                        id="addLicenseBtn">保存
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal fade bs-dis-auth-modal-lg" tabindex="-1" role="dialog"
                                     id="disLicenseModal"
                                     aria-labelledby="authLabel">
                                    <div class="modal-dialog modal-lg" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close"><span
                                                        aria-hidden="true">×</span></button>
                                                <h4 class="modal-title" id="disAuthLabel">取消许可证</h4>
                                            </div>
                                            <div class="modal-body col-xs-12">
                                                <div class="alert alert-success" role="alert" id="disLicenseUser">
                                                </div>
                                                <label for="licenseSelectModal2"></label>
                                                <select class="form-control" id="licenseSelectModal2"
                                                        style="height: 38px"
                                                        name="license-select" size="1">
                                                    <option value="" disabled selected hidden>请选择许可证</option>
                                                </select>
                                                <!--                                                <div class="col-xs-6">-->
                                                <!--                                                </div>-->

                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                                                </button>
                                                <button type="button" class="btn btn-primary" data-dismiss="modal"
                                                        id="disLicenseUserBtn">保存
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal fade bs-add-directory-role-member-lg" tabindex="-1" role="dialog"
                                     id="addDirectoryRoleMemberModal"
                                     aria-labelledby="authLabel">
                                    <div class="modal-dialog modal-lg" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close"><span
                                                        aria-hidden="true">×</span></button>
                                                <h4 class="modal-title">提升权限</h4>
                                            </div>
                                            <div class="modal-body col-xs-12">
                                                <!--                                                <div class="col-xs-6">-->
                                                <div class="alert alert-success" role="alert"
                                                     id="addDirectoryRoleMemberUsers">
                                                </div>
                                                <!--                                                </div>-->
                                                <label for="roleSelectModal"></label>
                                                <select class="form-control" id="roleSelectModal"
                                                        style="height: 38px"
                                                        name="license-select" size="1">
                                                </select>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                                                </button>
                                                <button type="button" class="btn btn-primary" data-dismiss="modal"
                                                        id="addDirectoryRoleMemberBtn">保存
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal fade bs-user-batch-modal-lg" tabindex="-1" role="dialog"
                                     id="addUserBatchModal"
                                     aria-labelledby="addUserBatchLabel">
                                    <div class="modal-dialog modal-lg" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close"><span
                                                        aria-hidden="true">×</span></button>
                                                <h4 class="modal-title" id="userLabelBatch">批量创建账户</h4>
                                            </div>
                                            <div class="modal-body col-xs-12">
                                                <h3 style="color: red">警告！ 该操作会在后台自动创建随机账号~</h3>
                                                <div class="col-xs-6">
                                                    <span id="licenseSelectModalUserIdBatch" hidden></span>
                                                    <label for="licenseSelectModalBatch"></label>
                                                    <select class="form-control" id="licenseSelectModalBatch"
                                                            style="height: 38px"
                                                            name="license-select-batch" size="1">
                                                        <option value="" disabled selected hidden>请选择许可证</option>
                                                    </select>
                                                    <label for="domainSelectModalBatch"></label>
                                                    <select class="form-control" id="domainSelectModalBatch"
                                                            style="height: 38px"
                                                            name="domain-select-batch" size="1">
                                                        <option value="" disabled selected hidden>请选择域名后缀</option>
                                                    </select>
                                                    <label for="usageLocationSelectModalBatch"></label>
                                                    <select class="form-control" id="usageLocationSelectModalBatch"
                                                            style="height: 38px"
                                                            name="domain-select-batch" size="1">

                                                    </select>
                                                </div>
                                                <div class="col-xs-2">

                                                    <label for="addUserBatchNum"></label>
                                                    <h4>请输入数量：</h4>
                                                </div>
                                                <div class="col-xs-3">
                                                    <label for="addUserBatchNum"></label>
                                                    <input class="form-control" id="addUserBatchNum" type="number"
                                                           min="2" max="100" step="1" value="10">
                                                </div>
                                                <div class="col-xs-2">
                                                    <label for="passwordSelectModalBatch"></label>
                                                    <h4>请输入密码：</h4>
                                                </div>
                                                <div class="col-xs-3">
                                                    <label for="passwordSelectModalBatch"></label>
                                                    <input class="form-control" id="passwordSelectModalBatch"
                                                           type="text"
                                                           placeholder="不填写则随机生成密码..">
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                                                </button>
                                                <button type="button" class="btn btn-primary" data-dismiss="modal"
                                                        onclick="addUserBatchClick()">保存
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--模糊框 end-->
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="usersTable" class="table table-bordered text-center">

                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <!-- 表单-->
            </div>

        </main>
        <!--End 页面主要内容-->
    </div>
</div>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="js/main.min.js"></script>
<script type="text/javascript" src="js/jconfirm/jquery-confirm.min.js"></script>
<script type="text/javascript" src="js/bootstrap-notify.min.js"></script>
<script type="text/javascript" src="js/lightyear.js"></script>

<script type="text/javascript" src='js/config.js'></script>
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript" src="js/users.js"></script>
<script type="text/javascript" src="js/plugins/gm.js"></script>
</body>
<script>
    // $(function () {
    //     $(".headerPage").load("header.html");
    //     // $(".footerpage").load("footer.html");
    // });
    // 确认提示框
    function getSelectedData() {
        let userPrincipalNames = [];
        let userIds = [];
        const checkedData = GM.getCheckedData('usersTable');
        for (const data of checkedData) {
            userIds.push(data.userId);
            userPrincipalNames.push(data.userPrincipalName);
        }
        return {userPrincipalNames, userIds};
    }

    $('.enable-account-p').on('click', function () {
        // $('input[name="userIds"]:checked').each(function () {//遍历每一个名字为interest的复选框，其中选中的执行函数
        //     let row = $(this).parent("label").parent("td").parent("tr");//获取选中行
        //     userIds.push(row.find("[name='userId']").html());//获取name='Sid'的值
        //     userPrincipalNames.push(row.find("[name='userPrincipalName']").html());
        // });
        let {userPrincipalNames, userIds} = getSelectedData();

        $.alert({
            title: '启用账户',
            content: '该操作会允许该用户登录，账号如下：<br><br><strong>' + userPrincipalNames.join('\n') + '</strong><br><br>',
            buttons: {
                confirm: {
                    text: '确认',
                    btnClass: 'btn-primary',
                    action: function () {
                        lightyear.loading('show');
                        // 假设ajax提交操作
                        for (const userId of userIds) {
                            enableUserWithUserId(userId);
                        }
                    }
                },
                cancel: {
                    text: '取消'
                }
            }
        });
    });
    $('.disable-account-p').on('click', function () {
        let {userPrincipalNames, userIds} = getSelectedData();
        $.alert({
            title: '禁用账户',
            content: '该操作会禁止该用户登录，账号如下：<br><br><strong>' + userPrincipalNames.join('\n') + '</strong><br><br>',
            buttons: {
                confirm: {
                    text: '确认',
                    btnClass: 'btn-primary',
                    action: function () {
                        lightyear.loading('show');
                        for (const userId of userIds) {
                            disableUserWithUserId(userId);
                        }
                    }
                },
                cancel: {
                    text: '取消'
                }
            }
        });
    });
    $('.deleted-account-p').on('click', function () {
        let {userPrincipalNames, userIds} = getSelectedData();
        $.alert({
            title: '删除账户',
            content: '<span style="color: red">警告！</span> 该操作会删除该账号，账号如下：<br><br><strong>' + userPrincipalNames.join('\n') + '</strong><br><br>',
            buttons: {
                confirm: {
                    text: '确认',
                    btnClass: 'btn-primary',
                    action: function () {
                        lightyear.loading('show');
                        for (let userId of userIds) {
                            deletedUserWithUserId(userId);
                        }
                    }
                },
                cancel: {
                    text: '取消'
                }
            }
        });
    });

    $('.deleted-account-p-batch').on('click', function () {
        $.alert({
            title: '<span style="color: red">警告！谨慎操作</span>',
            content: '</span> <h4>该操作会自动删除所有非管理员账号。</h4>',
            buttons: {
                confirm: {
                    text: '确认',
                    btnClass: 'btn-primary',
                    action: function () {
                        lightyear.loading('show');
                        deletedUserBatchClick();
                    }
                },
                cancel: {
                    text: '取消'
                }
            }
        });
    });


    $('#addLicenseModal').on('show.bs.modal', function () {
        let {userPrincipalNames, userIds} = getSelectedData();
        $('#addLicenseUser').html("你将为以下账号添加订阅：<br/>" + userPrincipalNames.join('<br/>'));
        setLicense("licenseSelectModal");
        $('#addLicenseBtn').click(function () {
            const skuId = getSelect("#licenseSelectModal");
            for (const userId of userIds) {
                addLicenseToUserWithSku(userId, skuId)
            }
        })
    });
    $('#disLicenseModal').on('show.bs.modal', function () {
        let {userPrincipalNames, userIds} = getSelectedData();
        $('#disLicenseUser').html("你将为以下账号账号取消订阅：<br/>" + userPrincipalNames.join('<br/>'));
        setLicense("licenseSelectModal2");
        let skuId = getSelect('#licenseSelectModal2');
        $('#disLicenseUserBtn').click(function () {
            for (const userId of userIds) {
                cancelLicenseForUser(userId, skuId);
            }
        })
    })
    $('#addDirectoryRoleMemberModal').on('show.bs.modal', function () {
        let {userPrincipalNames, userIds} = getSelectedData();
        $('#addDirectoryRoleMemberUsers').html("你将为以下账号提权：<br/>" + userPrincipalNames.join('<br/>'));
        setRoles('roleSelectModal');
        $('#addDirectoryRoleMemberBtn').click(function () {
                const roleId = getSelect('#roleSelectModal');
                for (const userId of userIds) {
                    addDirectoryRoleMember(userId, roleId);
                }
            }
        )
    })


</script>

</html>